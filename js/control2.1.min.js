/*
 * version  2016-07-07 12:30
 */
var LocalStorage={ifsupport:window.localStorage?true:false,setItem:function(a,b){try{window.localStorage.setItem(a,b)}catch(c){}},getItem:function(a){try{return window.localStorage.getItem(a)}catch(b){return null}},removeItem:function(a){try{window.localStorage.removeItem(a)}catch(b){}},checkStorage:function(a,b){},appendItem:function(d,g){try{var b=window.localStorage.getItem(d);if(!b){this.setItem(d,g);return}var a=b.length>0?b.split(","):[];if(a.length>2){for(var c=0;c<a.length-2;c++){var f=a.shift();if(f!==g){this.removeItem(f+"_subtitle");this.removeItem(f+"_remainTitles");this.removeItem(f+"_SUBTITLEAXIS");this.removeItem(f+"_SUBTITLEAXIS_REMAIN")}}}b=a.join(",");if(b.indexOf(g)<0){a.push(g)}window.localStorage.setItem(d,a.join(","))}catch(h){}}};var Cookie={set:function(d,e,b){this.remove(d);var c="";if(b){var f=new Date().getTime();f+=b;c=";expires="+new Date(f).toGMTString()}var a=";domain=yxgapp.com";document.cookie=d+"="+encodeURIComponent(e)+c+a},get:function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(b>-1){b=b+a.length+1;var c=document.cookie.indexOf(";",b);if(c===-1){c=document.cookie.length}return decodeURIComponent(document.cookie.substring(b,c))}}return""},remove:function(d){if(document.cookie.length>0){var a=document.cookie.split(";");for(var c=0;c<a.length;c++){var b=a[c].split("=");if(b[0]===d){a.pop(c);break}}}}};var videoPlayer={init:function(b,c){this.containerId=b;this.container=$("#"+this.containerId);var a=this.container.width();var d=a*9/16;this.container.height(d);this.video=$(this.container).find("video")[0];this.options=c;this.userInfo=c.userInfo;this.controlBtn=$(this.container).find(".play-btn")[0];this.trigger=$(this.container).find(".video-trigger")[0];this.mask=$(this.container).find(".video-mask")[0];this.startPlay=false;$(this.video).attr("preload","auto");this.videoId=this.options.videoId;this.getData();this.requestTime=0;this.startTime=0},changeVideo:function(a,b){this.dataIsok=false;this.startPlay=false;this.videoId=b;this.currentTime=0;this.totalTime=0;this.data=a},initData:function(a,b){if(!a.result.result){if(this.options.onDataError){this.options.onDataError(a)}}else{if(!this.dataIsok){this.dataIsok=true;this.data=a.video;if(this.options.onDataok){this.options.onDataok(this.data)}if(!this.eventIfOk){this.eventIfOk=true;this.addEvent()}this.initPlayer();if(b){b(a)}}}},getData:function(){var c="http://m.yxgapp.com/d/mooc/GetVideo.json",a=this;var b={videoId:this.videoId,token:this.userInfo.token,username:this.userInfo.username};a.requestTime++;$.ajax({url:c,data:b,dataType:"json",success:function(d){a.initData(d)},error:function(){if(a.requestTime<3){setTimeout(function(){a.getData()},2000)}}})},initPlayer:function(){this.poster=document.createElement("img");this.poster.src=this.data.coverUrl;$(this.video).after(this.poster);this.video.src=this.data.url;this.video.load();$(this.video).show();this.totalTime=this.data.durationHour;if(this.options.autoPlay){this.video.play()}},addEvent:function(){var a=this;$(this.controlBtn).on("click",function(){a.play();return false});$(this.trigger).on("mouseenter",function(f){a.showControl()});$(this.trigger).on("mouseleave",function(f){a.hideControl()});$(this.trigger).on("click",function(){a.showControl()});var d={"play":"onPlay","pause":"onPause","timeupdate":"onTimeUpdate","error":"onError","ended":"onEnded","seeking":"onSeeking","seeked":"onSeeked","waiting":"onWating"};function e(h,f){var g=Array.prototype.slice.call(arguments).slice(2);return function(i){return f.apply(h,[i||window.event].concat(g))}}for(var b in d){var c=e(this,this[d[b]]);$(this.video).on(b,c)}},hideControl:function(){if(!this.startPlay||this.video.paused||$(this.controlBtn).css("display")==="none"){return}$(this.controlBtn).fadeOut();$(this.mask).fadeOut()},showControl:function(){if(this.startPlay){$(this.controlBtn).fadeIn();$(this.mask).fadeIn()}},showLoading:function(){if($(".loading")){$(".loading").show()}},hideLoading:function(){if($(".loading")){$(".loading").hide()}},changeBtnState:function(a){if(a){$(this.trigger).removeClass("playbtn");$(this.trigger).addClass("pausebtn")}else{$(this.trigger).addClass("playbtn");$(this.trigger).removeClass("pausebtn")}},removeEvent:function(){},onPlay:function(){this.startPlay=true;$(this.poster).fadeOut("slow");this.changeBtnState(true);this.hideControl()},onPlaying:function(){},onEnded:function(){this.showControl();this.changeBtnState(false);if(this.options.onEnd){this.options.onEnd()}},onPause:function(){this.changeBtnState(false);this.showControl()},onWating:function(){this.showLoading()},onTimeUpdate:function(){this.hideLoading();this.currentTime=this.video.currentTime;this.options.onUpdate?this.options.onUpdate(this.video.currentTime):""},onError:function(){alert("the video play is error")},onSeeking:function(a){},onSeeked:function(a){this.showLoading()},play:function(){$(this.poster).fadeOut("slow");if(!this.startPlay){if(this.startTime>0){this.video.currentTime=this.startTime;
this.startTime=0}this.video.play()}else{if(this.video.paused){this.video.play()}else{this.video.pause()}}},pause:function(){this.video.pause()},isPause:function(){return this.video.paused},seek:function(a,b){this.video.currentTime=a;if(b){b(this.currentTime)}this.video.play()},setStartTime:function(a){this.startTime=a}};var subtitle={init:function(a,b){this.container=$("#"+a);this.videoId=b.videoId;this.dataOk=false;this.options=b;this.userInfo=b.userInfo;this.storeKey=this.videoId+"_subtitle";this.remainKey=this.videoId+"_remainTitles";this.requestTime=0;this.showNum=5;if(videoPlayer){this.player=videoPlayer}this.params={videoId:this.videoId,token:this.userInfo.token,username:this.userInfo.username};var d=this.storeKey;if(LocalStorage.getItem(d)){var c=JSON.parse(LocalStorage.getItem(d));if(c){this.version=c.version;this.data=c}else{this.version=-1}}else{this.version=-1}this.initRemainTitle();LocalStorage.appendItem("videos",this.videoId);this.getData()},getData:function(){this.requestTime++;var c="http://m.yxgapp.com/mooc/"+this.params.videoId+"/DownloadSubtitle.json?"+new Date().getTime(),a=this;var b=this.params;b.version=this.version;$.ajax({url:c,dataType:"json",data:b,success:function(d){a.getCallback(d)},error:function(){if(a.requestTime<3){setTimeout(function(){a.getData()},2000)}}})},getCallback:function(a){if(!a.result.result){if(this.options&&this.options.errorFun){this.options.errorFun(a.result)}else{alert("登录失效，请重新登录")}}else{a.subtitle.subtitleItems=this.handleItems(a.subtitle.subtitleItems,a.subtitle.subtitleTimestamp);if(this.version===-1){this.data=a.subtitle;this.version=a.subtitle.subtitleTimestamp;a.subtitle.version=this.version;this.dataOk=true;this.initData()}else{this.checkLocalData(a.subtitle);this.initData()}LocalStorage.setItem(this.storeKey,JSON.stringify(this.data))}},initData:function(){if(this.options.onDataok){this.options.onDataok(this.data)}this.totalNum=this.data.subtitleItems.length;this.curIndex=this.data.subtitleItems[0]?0:this.getNextIndex(0);this.pIndex=0;this.unComplateIndex=0;this.curEndTime=this.data.subtitleItems[this.curIndex].endTime/1000;this.createSubtitle(this.data.subtitleItems);this.setCheckTimer();this.totalDom=this.liDomList.length;this.addEvent();this.setPositionParams();this.scrollToUncomplete()},initRemainTitle:function(){if(LocalStorage.getItem(this.remainKey)){var a=JSON.parse(LocalStorage.getItem(this.remainKey));if(a){this.remainSubtitles=a}else{this.remainSubtitles=[]}}else{this.remainSubtitles=[]}},setPositionParams:function(){this.lineHeight=$(this.liDomList[0]).outerHeight();this.showNum=parseInt(this.container.height()/this.lineHeight)},queueItems:function(b){var a=b.length;var e=new Array(a);for(var d=0;d<a;d++){var c=this.checkItem(b[d]);e[c.index-1]=c}return e},handleItems:function(b,e,g){var f=0,k=b.length,a=[];for(;f<k;f++){var h={};h.id=b[f].id;h.startTime=b[f].startTime;h.endTime=b[f].endTime;h.index=(f+1);h.version=e;h.isDifficult=b[f].isDifficult;var c=b[f].data;var d=0,l=c.length;if(l===0){h.baseSubtitleItem=null;h.extSubtitleItem=null}else{if(l===1){h.baseSubtitleItem=c[0];h.baseSubtitleItem.isDifficult=3;h.extSubtitleItem=null}else{h.baseSubtitleItem=c[0];h.extSubtitleItem=c[1];h.baseSubtitleItem.isDifficult=3;h.extSubtitleItem.isDifficult=3}}h=this.checkItem(h);h.baseSubtitleItem.language==="英文"?h.baseSubtitleItem.language="en":"";h.extSubtitleItem.language==="中文"?h.extSubtitleItem.language="ch":"";a.push(h)}return a},checkItem:function(a){a.sTime=this.getTimeModel(a.startTime);a.eTime=this.getTimeModel(a.endTime);if(!a.baseSubtitleItem){a.baseSubtitleItem={subtitleItemId:a.id,historyType:1,content:"",isDifficult:3,autoCaption:0,language:"en"}}if(!a.extSubtitleItem){a.extSubtitleItem={subtitleItemId:a.id,historyType:2,content:"",isDifficult:3,autoCaption:0,language:"ch"}}return a},scrollToUncomplete:function(){var b=$(this.liDomList[this.unComplateIndex]).attr("data-index");var a=this.data.subtitleItems[parseInt(b)].startTime/1000;videoPlayer.setStartTime(a);this.changeCurItem(this.unComplateIndex);$(this.liDomList[this.unComplateIndex]).find(".ch-area").focus()},checkLocalData:function(f){var a=f.subtitleItems,b=a.length;for(var d=0;d<b;d++){var c=a[d];var g=c.index-1;var e=this.data.subtitleItems[g];if(c.version>this.data.subtitleItems[g].version){c=this.checkItem(c);this.data.subtitleItems[g]=c}}if(f.version>this.data.version){this.data.version=f.version;this.version=f.version}},getNextIndex:function(c){var a=false,b=c+1;while(!a&&b<this.totalNum){if(!this.data.subtitleItems[b]){b++}else{a=true}}return b},addEvent:function(){if(this.eventOk){return}this.eventOk=true;var a=this;this.container.delegate("li","click",function(b){a.changeIndex($(this),b);return false});this.container.delegate(".ch-area","click",function(b){a.chClick($(this),b);return false});this.container.delegate(".ch-area","focus",function(b){a.edit=true;a.editType="ch";return false});this.container.delegate(".ch-area","blur",function(b){a.chBlur($(this),b);return false
});this.container.delegate(".en-txt","dblclick",function(b){a.enClick($(this),b);return false});this.container.delegate(".en-area","blur",function(b){a.enBlur($(this),b);return false});this.addKeyDownEvent()},addKeyDownEvent:function(){var a=this;document.onkeydown=function(b){var c=b||window.event||arguments.callee.caller.arguments[0];if(c.shiftKey&&c.keyCode==9){a.tabClick(b,false)}else{if(c&&c.keyCode==9){a.tabClick(b,true)}}}},tabClick:function(c,b){var d=0;if(b){d=(this.pIndex+1<this.totalDom)?(this.pIndex+1):this.pIndex}else{d=(this.pIndex-1>=0)?(this.pIndex-1):this.pIndex}var a=$(this.liDomList[d]);var e=a.find(".ch-area");if(d===this.pIndex){e.focus();return}e.click()},changeIndex:function(b,a){var c=this.player.isPause();if(c){this.seekVideo(b.attr("data-index"))}this.changeCurItem(b.attr("data-pindex"),a);return false},chClick:function(b,a){this.edit=true;this.editType="ch";this.changeIndex(b,a);return false},chBlur:function(c,b){this.edit=false;this.editType=null;var f=parseInt(c.attr("data-index"));var a=this.data.subtitleItems[f];var d=this.fillStr(c.val());c.val(d);if(a.extSubtitleItem.content!==d){a.extSubtitleItem.content=d;a.extSubtitleItem.updateTime=parseInt(new Date().getTime()/1000);a.extSubtitleItem.username=this.userInfo.username;a.extSubtitleItem.userNickname=this.userInfo.nickname;a.extSubtitleItem.autoCaption=0;a.extSubtitleItem.isDifficult=3;this.saveSubtitle(a.extSubtitleItem,f)}},enClick:function(b,a){this.edit=true;this.editType="en";val=b.text();b.hide();b.siblings(".en-area").val(val).show().focus();this.changeIndex(b,a);return false},enBlur:function(c,b){this.edit=false;this.editType=null;val=this.fillStr(c.val());c.hide();c.siblings(".en-txt").text(val).show();if(/.*[\u4e00-\u9fa5]+.*$/.test(val)){c.siblings(".en-txt").addClass("en-error");return}c.siblings(".en-txt").removeClass("en-error");var d=parseInt(c.attr("data-index"));var a=this.data.subtitleItems[d].baseSubtitleItem;if(a.content!==val&&val!==""){a.content=val;a.updateTime=parseInt(new Date().getTime()/1000);a.autoCaption=0;a.username=this.userInfo.username;a.userNickname=this.userInfo.nickname;a.isDifficult=3;this.saveSubtitle(a,d)}},changByTime:function(a){if(this.edit&&this.curEndTime<a){this.player.pause()}if(!this.edit&&this.curEndTime<a&&(this.pIndex+1)<this.totalDom){var b=this.pIndex+1;this.changeCurItem(b)}},changeCurItem:function(a,b){a=parseInt(a);$(this.liDomList[this.pIndex]).removeClass("active");var d=$(this.liDomList[a]);d.addClass("active");var c=parseInt(d.attr("data-index"));this.curEndTime=this.data.subtitleItems[c].endTime/1000;this.scroll(a);b?this.seekVideo(c):"";this.curIndex=c;this.pIndex=a},scroll:function(b){var a=b===0?0:(b-1)*this.lineHeight;this.container.mCustomScrollbar("scrollTo",a)},seekVideo:function(b){var a=this.data.subtitleItems[b].startTime;this.player.seek(a/1000)},getTimeModel:function(c){var b=parseInt(c/1000);var a=parseInt(b/60);var d=parseInt(a/60);a=a>9?a:("0"+a);b=b%60;_secondStr=b>9?b:("0"+b);if(d>0){return d+":"+a+":"+_secondStr}else{return a+":"+_secondStr}},fillStr:function(a){a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/^\n+|\n+$/g,"");return a},createSubtitle:function(e){var a=e.length;this.ulDom=this.container.find("ul").length===0?$(document.createElement("ul")):$(this.container.find("ul")[0]);this.ulDom.css({positon:"relative",top:0,left:0});var f=0;for(var d=0;d<a;d++){var b=document.createElement("li"),h=[],c=e[d];if(!c){continue}var g=c.index;$(b).attr("data-pindex",f);$(b).attr("data-index",(g-1));if(d===this.curIndex){$(b).addClass("active")}h.push('<div class="trans-en">');h.push('<div class="sign clearfix">');h.push('<div class="gather circle fl"></div>');h.push('<span class="dur-time fl">'+c.sTime+"</span>");if(c.baseSubtitleItem){c.baseSubtitleItem.autoCaption===1?h.push('<div class="gather auto fl"></div>'):h.push("");h.push("</div>");h.push('<div data-index="'+(g-1)+'" data-pindex = "'+f+'" class="en-txt">'+c.baseSubtitleItem.content+"</div>");h.push('<textarea class="en-area" data-index="'+(g-1)+'"data-pindex = "'+f+'"></textarea>');h.push("</div>")}h.push('<div class="trans-ch"><div class="sign clearfix">');h.push('<div class="gather circle fl"></div>');if(c.extSubtitleItem){c.extSubtitleItem.isDifficult===2?h.push('<div class="gather square fl"></div>'):h.push("");h.push("</div>");h.push('<textarea data-index = "'+(g-1)+'" data-pindex = "'+f+'" class="ch-area"');h.push(">");h.push(c.extSubtitleItem.content+"</textarea>");h.push("</div>")}$(b).html(h.join(""));if(c.extSubtitleItem.content===""&&this.unComplateIndex===0){this.unComplateIndex=f}this.ulDom.append(b);f++}this.container.html(this.ulDom);this.liDomList=this.container.find("li");this.container.mCustomScrollbar({theme:"my-theme",mouseWheel:{scrollAmount:131},})},postData:function(b,e){if(!b||!e||e.length===0){return}var d="";var c={};c.token=this.params.token;c.username=this.params.username;c.videoId=this.params.videoId;c.version=b;c.newSubtitle=JSON.stringify(e);c.from=3;var a=this;$.ajax({url:"http://m.yxgapp.com/d/mooc/UpdateSubtitle.json",data:c,type:"POST",dataType:"json",success:function(f){if(f.result.result){a.resetSubTitleItems(f)
}else{a.setRemainSubTitles(e);if(a.options&&a.options.errorFun){a.options.errorFun(f.result)}else{alert("登录失效，请重新扫码登录")}}},error:function(f){a.setRemainSubTitles(e)}})},setCheckTimer:function(){var a=this;if(this.remainSubtitles.length>0){this.postData(this.version,this.remainSubtitles);this.remainSubtitles=[];LocalStorage.removeItem(this.remainKey)}this.timer=setTimeout(function(){a.setCheckTimer()},1000*120)},setRemainSubTitles:function(g){var a=this.remainSubtitles.length,d=g.length;for(var c=0;c<d;c++){var f=g[c].id;var e=false;for(var b=0;b<a;b++){if(this.remainSubtitles[b].id===g[c].id){this.remainSubtitles[b]=g[c];e=true;break}}if(!e){this.remainSubtitles.push(g[c])}}LocalStorage.setItem(this.remainKey,JSON.stringify(this.remainSubtitles))},saveSubtitle:function(b,d){if(parseInt(b.historyType)===1){this.data.subtitleItems[d].baseSubtitleItem=b}else{this.data.subtitleItems[d].extSubtitleItem=b}this.data.subtitleItems[d].version=this.data.version;LocalStorage.setItem(this.storeKey,JSON.stringify(this.data));var c=this.data.version;var a=[];a.push(b);this.postData(c,a)},resetSubTitleItems:function(a){this.data.version=a.timestamp;this.version=this.data.version;LocalStorage.setItem(this.storeKey,JSON.stringify(this.data))},getStatus:function(){var b=this.params;b.subtitleTimestamp=Math.ceil(new Date().getTime()/1000);var a=this;$.ajax({url:"http://m.yxgapp.com/d/mooc/GetStaticSubtitleState.json",data:b,type:"GET",dataType:"json",success:function(c){if(c.result){}},error:function(){a.getData()}})},resetOption:function(){this.changeCurItem(0)}};var contentControl={init:function(d,b){this.getUserInfo();this.showUserInfo();var a=this;var e={errorFun:function(){a.showErrorNote()},onDataok:function(){a.subTitleOK=true;if(a.videoOk){a.hideLoadNote()}},userInfo:this.userInfo,videoId:this.videoId};b.init("js_tranList",e);var c={onStartPlay:null,onEnd:function(){b.resetOption()},onError:null,onDataError:null,onPause:null,onDataok:function(f){a.videoData=f;a.videoOk=true;a.showVideoInfo(a.videoData);if(a.subTitleOK){a.hideLoadNote()}},onUpdate:function(f){b.changByTime(f)},userInfo:this.userInfo,videoId:this.videoId};d.init("video_container",c);this.getCourseData();this.courseRequestTime=0},showLoadNote:function(a){$("#js_mask").show();if(a){$("#js_note .layui-layer-content").html(a)}$("#js_note .layui-layer-btn").hide();$("#js_note").show()},hideLoadNote:function(){$("#js_mask").hide();$("#js_note").hide()},showErrorNote:function(d){this.hideLoadNote();d=d?d:"登陆状态失效，请重新扫描二维码进行登录";var b="http://t.yxgapp.com/index.html";$("#js_mask").show();var c=$("#js_note .layui-layer-btn0");var a=$("#js_note .layui-layer-content").html(d);c.html("前往扫描二维码");c.attr("href",b);$("#js_note .layui-layer-btn").show();$("#js_note").show();window.tokenError=true},showUserInfo:function(b){if(this.userInfo.avatarUrl&&this.userInfo.avatarUrl!="null"){$("#js_userpic").attr("src",this.userInfo.avatarUrl)}var a=this.userInfo.nickname&&this.userInfo.nickname!="null"?this.userInfo.nickname:"";$("#js_nickname").html(a)},getCourseData:function(){var b={};this.courseRequestTime++;b.username=this.userInfo.username;b.token=this.userInfo.token;b.courseId=this.courseId;b.command="command_detail";var a=this;$.ajax({url:"http://m.yxgapp.com/d/mooc/PutOpenCourseRecord.json",data:b,type:"GET",dataType:"json",success:function(c){a.showCourseInfo(c)},error:function(c){if(this.courseRequestTime<3){a.getCourseData()}else{a.showLoadNote("网络不通畅，请检查之后刷新页面")}}})},showCourseInfo:function(a){if(!a.result.result){this.showErrorNote()}else{this.courseData=a.data;if(this.courseData.videoNumber>1){$("#js_coursetitle").html(this.courseData.name)}else{$("#js_coursetitle").html(this.courseData.enName)}this.showUniversity()}},showUniversity:function(){if(this.courseData.joinNumber){$("#js_joinCount").html(this.courseData.joinNumber+"次")}if(!this.courseData.university&&!this.courseData.authors){$("#js_courseInfo").hide()}else{if(this.courseData.university){var a=document.createElement("img");$(a).attr("src",this.courseData.university.iconUrl);var e=document.createElement("span");$(e).html(this.courseData.university.name);var c=$("#js_courseinfo .unit");c.append(a);c.append(e)}var d=document.createElement("div");$(d).attr("class","teacher-info");var g=$("#js_courseinfo .teacher");var b=document.createElement("img");if(this.courseData.authors.length>0){var f=this.courseData.authors[0];$(b).attr("src",f.iconUrl);$(d).html('<div class="name">'+f.name+'</div><div class="rank">'+f.jobTitle+"</div>");g.append(b);g.append(d)}else{$(d).html('<div style="margin:11px 0 0 4px;" class="name">迷你课</div>');$(b).attr("src",this.courseData.marketCoverUrl);g.append(b);g.append(d)}}},showVideoInfo:function(d){$("#js_videotitle").html(d.name);var a=d.translateInfo,e=a.allTranslateSentencesNumber,c=a.baseSentencesNumber,b=(e/c*100).toFixed(0);$("#js_progress").html(b+"%");$("#js_total").html(c+"句")},getUserInfo:function(){this.userInfo={};this.userInfo.username=Cookie.get("userId");
this.userInfo.token=Cookie.get("token");this.courseId=Cookie.get("courseId");this.videoId=Cookie.get("videoId");this.userInfo.nickname=Cookie.get("nickname");this.userInfo.avatarUrl=Cookie.get("avatarUrl")},showNote:function(e,c,f){var d=$("#js_note1");d.find(".layui-layer-content").html(e);$("#js_mask").show();if(f){var b=d.find(".layui-layer-btn0");var a=this;b.show();b.on("click",function(){a.hideNote();f()})}else{d.find(".layui-layer-btn0").hide()}d.show()},hideNote:function(b){$("#js_mask").hide();var a=$("#js_note1");a.hide()},checkSupport:function(){var b=["您的浏览器版本较低，请更换为Chrome或者Firefox最新版本再来使用。","注意：我们未对您的浏览器进行过兼容性测试，使用过程中可能会存在问题，建议使用Chrome或者Firefox浏览器最新版本。"];if(!window.localStorage||!window.localStorage.setItem){this.hideLoadNote();this.showNote(b[0]);return false}var d=window.navigator.userAgent;if(d.indexOf("Chrome")<0&&d.indexOf("Safari")<0&&d.indexOf("Firefox")<0){var a=this;var c=function(){a.hideNote();a.showLoadNote();a.init(videoPlayer,subtitle)};this.showNote(b[1],{},c);return false}this.init(videoPlayer,subtitle);return true}};window.onload=function(){contentControl.checkSupport();$(document).on("visibilitychange",function(){if(document.hidden){videoPlayer.pause()}})};window.onbeforeunload=function(){if(subtitle.remainSubtitles.length>0&&!windows.tokenError){return"当前尚有字幕未同步到平台，离开可能会导致数据丢失，是否确认离开？"}};window.onblur=function(){videoPlayer.pause()};